# HawkScan DAST Configuration for TutorLingua
# Documentation: https://docs.stackhawk.com/hawkscan/

app:
  applicationId: 2ca4a573-8115-451d-87d3-158c3d720a79
  env: Production
  host: https://tutorlingua.co

  # Authentication configuration for scanning protected routes
  authentication:
    loggedInIndicator: "\\Qdashboard\\E|\\QLog out\\E|\\QSign out\\E"
    loggedOutIndicator: "\\QLog in\\E|\\QSign up\\E|\\Qlogin\\E"
    usernamePassword:
      type: FORM
      loginPagePath: /login
      loginPath: /login
      usernameField: email
      passwordField: password
      scanUsername: ${HAWKSCAN_TUTOR_EMAIL}
      scanPassword: ${HAWKSCAN_TUTOR_PASSWORD}
    cookieAuthorization:
      cookieNames:
        - sb-ptvphehyuxnmshxoebeq-auth-token
        - sb-ptvphehyuxnmshxoebeq-auth-token.0
        - sb-ptvphehyuxnmshxoebeq-auth-token.1
    testPath:
      path: /dashboard
      success: ".*200.*"

  # Paths to exclude from scanning (webhooks, payments, admin ops)
  excludePaths:
    - /api/stripe/webhook
    - /api/stripe/connect/webhook
    - /api/webhooks/.*
    - /api/cron/.*
    - /api/stripe/booking-checkout
    - /api/stripe/subscription-checkout
    - /api/stripe/create-checkout-session
    - /api/stripe/lifetime
    - /api/stripe/billing-portal
    - /api/digital-products/checkout
    - /api/practice/subscribe
    - /api/stripe/connect/accounts
    - /api/stripe/connect/account-link
    - /api/stripe/connect/login-link
    - /api/admin/.*
    - /api/calendar/oauth/.*
    - /calendar-callback
    - /api/upload.*
    - /api/site-assets/.*
    - /api/email/.*
    - /api/refunds/.*
    - /password-gate
    - /api/password-gate/.*
    - /api/livekit/recording
    - /_next/.*
    - /favicon.ico
    - /robots.txt
    - /sitemap.xml

hawk:
  spider:
    base: true
    ajax: false
    maxDurationMinutes: 25
    # Comprehensive seed paths for thorough scanning (targeting 100+ URLs)
    seedPaths:
      # Public pages - Landing & Marketing
      - /
      - /login
      - /signup
      - /pricing
      - /terms
      - /privacy
      - /forgot-password
      - /reset-password
      # Help Center
      - /help
      - /help/getting-started
      - /help/booking
      - /help/payments
      - /help/calendar
      - /help/students
      - /help/marketing
      - /help/studio
      - /help/ai-practice
      - /help/account
      # Blog
      - /blog
      # Student Portal (public auth pages)
      - /student/login
      - /student/signup
      # Tutor Dashboard - Core
      - /dashboard
      - /bookings
      - /bookings/new
      - /students
      - /students/import
      - /services
      - /availability
      - /calendar
      - /messages
      - /notifications
      # Analytics
      - /analytics
      - /analytics/students
      - /analytics/revenue
      # Products & Pages
      - /digital-products
      - /pages
      - /marketing
      - /practice-scenarios
      # Settings (comprehensive)
      - /settings
      - /settings/profile
      - /settings/payments
      - /settings/calendar
      - /settings/billing
      - /settings/notifications
      # Other tutor pages
      - /upgrade
      - /onboarding
      - /classroom
      - /ai
      # API routes (safe read-only endpoints)
      - /api/auth/me
      - /api/pricing/founder
