-- Add missing FK indexes to speed up joins and deletes
-- Generated for performance alignment across Supabase tables

CREATE INDEX IF NOT EXISTS idx_booking_reschedule_history_student_id ON booking_reschedule_history (student_id);
CREATE INDEX IF NOT EXISTS idx_bookings_service_id ON bookings (service_id);
CREATE INDEX IF NOT EXISTS idx_content_reports_reporter_id ON content_reports (reporter_id);
CREATE INDEX IF NOT EXISTS idx_content_reports_resolved_by ON content_reports (resolved_by);
CREATE INDEX IF NOT EXISTS idx_digital_product_purchases_product_id ON digital_product_purchases (product_id);
CREATE INDEX IF NOT EXISTS idx_email_suppressions_last_event_id ON email_suppressions (last_event_id);
CREATE INDEX IF NOT EXISTS idx_grammar_errors_message_id ON grammar_errors (message_id);
CREATE INDEX IF NOT EXISTS idx_grammar_errors_tutor_id ON grammar_errors (tutor_id);
CREATE INDEX IF NOT EXISTS idx_homework_assignments_booking_id ON homework_assignments (booking_id);
CREATE INDEX IF NOT EXISTS idx_learning_roadmaps_tutor_id ON learning_roadmaps (tutor_id);
CREATE INDEX IF NOT EXISTS idx_lesson_deliveries_package_purchase_id ON lesson_deliveries (package_purchase_id);
CREATE INDEX IF NOT EXISTS idx_lesson_drills_tutor_id ON lesson_drills (tutor_id);
CREATE INDEX IF NOT EXISTS idx_lesson_recordings_student_id ON lesson_recordings (student_id);
CREATE INDEX IF NOT EXISTS idx_lifetime_purchases_claimed_by ON lifetime_purchases (claimed_by);
CREATE INDEX IF NOT EXISTS idx_link_events_link_id ON link_events (link_id);
CREATE INDEX IF NOT EXISTS idx_links_tutor_id ON links (tutor_id);
CREATE INDEX IF NOT EXISTS idx_marketing_clips_recording_id ON marketing_clips (recording_id);
CREATE INDEX IF NOT EXISTS idx_marketplace_transactions_purchase_id ON marketplace_transactions (purchase_id);
CREATE INDEX IF NOT EXISTS idx_payments_audit_student_id ON payments_audit (student_id);
CREATE INDEX IF NOT EXISTS idx_phonetic_errors_message_id ON phonetic_errors (message_id);
CREATE INDEX IF NOT EXISTS idx_phonetic_errors_session_id ON phonetic_errors (session_id);
CREATE INDEX IF NOT EXISTS idx_phonetic_errors_tutor_id ON phonetic_errors (tutor_id);
CREATE INDEX IF NOT EXISTS idx_plan_overrides_created_by ON plan_overrides (created_by);
CREATE INDEX IF NOT EXISTS idx_platform_config_updated_by ON platform_config (updated_by);
CREATE INDEX IF NOT EXISTS idx_practice_assignments_scenario_id ON practice_assignments (scenario_id);
CREATE INDEX IF NOT EXISTS idx_practice_usage_periods_tutor_id ON practice_usage_periods (tutor_id);
CREATE INDEX IF NOT EXISTS idx_pronunciation_assessments_session_id ON pronunciation_assessments (session_id);
CREATE INDEX IF NOT EXISTS idx_pronunciation_assessments_tutor_id ON pronunciation_assessments (tutor_id);
CREATE INDEX IF NOT EXISTS idx_recurring_lesson_reservations_service_id ON recurring_lesson_reservations (service_id);
CREATE INDEX IF NOT EXISTS idx_refund_requests_payments_audit_id ON refund_requests (payments_audit_id);
CREATE INDEX IF NOT EXISTS idx_refund_requests_processed_by_user_id ON refund_requests (processed_by_user_id);
CREATE INDEX IF NOT EXISTS idx_refund_requests_student_id ON refund_requests (student_id);
CREATE INDEX IF NOT EXISTS idx_session_package_purchases_student_id ON session_package_purchases (student_id);
CREATE INDEX IF NOT EXISTS idx_session_package_templates_service_id ON session_package_templates (service_id);
CREATE INDEX IF NOT EXISTS idx_session_package_templates_tutor_id ON session_package_templates (tutor_id);
CREATE INDEX IF NOT EXISTS idx_spaced_repetition_items_source_lesson_id ON spaced_repetition_items (source_lesson_id);
CREATE INDEX IF NOT EXISTS idx_student_audio_budgets_tutor_id ON student_audio_budgets (tutor_id);
CREATE INDEX IF NOT EXISTS idx_student_grammar_patterns_category_slug ON student_grammar_patterns (category_slug);
CREATE INDEX IF NOT EXISTS idx_student_grammar_patterns_tutor_id ON student_grammar_patterns (tutor_id);
CREATE INDEX IF NOT EXISTS idx_student_practice_sessions_scenario_id ON student_practice_sessions (scenario_id);
CREATE INDEX IF NOT EXISTS idx_support_tickets_student_id ON support_tickets (student_id);
CREATE INDEX IF NOT EXISTS idx_support_tickets_tutor_id ON support_tickets (tutor_id);
CREATE INDEX IF NOT EXISTS idx_system_error_log_resolved_by ON system_error_log (resolved_by);
CREATE INDEX IF NOT EXISTS idx_tutor_invite_link_usages_student_id ON tutor_invite_link_usages (student_id);
CREATE INDEX IF NOT EXISTS idx_tutor_site_services_service_id ON tutor_site_services (service_id);
CREATE INDEX IF NOT EXISTS idx_tutor_site_versions_created_by ON tutor_site_versions (created_by);
CREATE INDEX IF NOT EXISTS idx_tutor_status_history_changed_by ON tutor_status_history (changed_by);
